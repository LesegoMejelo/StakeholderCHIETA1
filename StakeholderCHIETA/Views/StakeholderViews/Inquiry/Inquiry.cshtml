@{
    Layout = null;
}

<html>
<head>
    <meta charset="utf-8" />
    <title>Inquiry Page</title>
    <link rel="stylesheet" href="~/Content/StakeholderView/Style.css" />

</head>
<body>

    <div class="navbar">
        <img src="https://acfesa.co.za/sites/default/files/inline-images/CHIETA%20Logo.png">
    </div>

    <div class="container">
        <div class="title">Log an Inquiry</div>

        <!-- Inquiry Type Dropdown -->
        <div class="dropdown">
            <label for="inquiryType">Select Inquiry Type:</label>
            <select id="inquiryType">
                <option value="">-- Choose an option --</option>
                <option value="Feedback Follow-Up">Feedback Follow-Up</option>
                <option value="Training Availability">Training Availability</option>
                <option value="Accreditation and Compliance">Accreditation and Compliance</option>
                <option value="Funding and Grants">Funding and Grants</option>
                <option value="Boardroom/Facility Use">Boardroom/Facility Use</option>
                <option value="Other">Other</option>
            </select>
        </div>

        <!--Comment section-->
        <div class="Comment-section">
            <label for="issue">Describe Issue:</label>
            <textarea id="issue" placeholder="Type your issue here..."></textarea>

            Message and Name Input -->

            <div class="Comment-section NameLabel"
            <label for="nameInput">Your Name:</label>
            <input type="text" id="nameInput" placeholder="Your name" />
            </div>


            <!--Submit Button-->
            <button id="submitBtn" type="button">Submit</button>

            <!--Confirmation message-->

            <div id="confirmationMessage" class="cloud-message" style="display: none;">
                Your inquiry has been submitted. Please expect to hear from us within the next 3 business days.
            </div>
        </div>
    </div>

    <script>
        document.getElementById("submitBtn").addEventListener("click", async function () {
            const name = document.getElementById("nameInput").value.trim();
            const message = document.getElementById("issue").value.trim();
            const inquiryType = document.getElementById("inquiryType").value;

            // Basic validation
            if (!message || !inquiryType) {
                alert("Please fill in all fields.");
                return;
            }

            try {
                const response = await fetch("/api/inquiry", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                    body: new URLSearchParams({
                        name: name || "Anonymous",
                        message: message,
                        inquiryType: inquiryType
                    })
                });

                const result = await response.json();
                console.log("Server response:", result);

                // Show confirmation
                document.getElementById("confirmationMessage").style.display = "block";

                // Clear form
                document.getElementById("nameInput").value = "";
                document.getElementById("issue").value = "";
                document.getElementById("inquiryType").value = "";

            } catch (error) {
                console.error("Submission failed:", error);
                alert("Something went wrong. Please try again.");
            }
        });
    </script>

</body>
</html>
